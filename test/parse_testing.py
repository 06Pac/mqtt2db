import json
import unittest

LHT_saxion = b'{"end_device_ids":{"device_id":"lht-saxion","application_ids":{"application_id":"project-software-engineering"},"dev_eui":"A840411661835048","join_eui":"A000000000000100","dev_addr":"260B4913"},"correlation_ids":["as:up:01GJXW7H3NSAVJMDA4PXZA0HCF","gs:conn:01GJXVFMMFRA1RXQJ73WBHGTPT","gs:up:host:01GJXVFMMQ0NAZPZ141BM8WJ8F","gs:uplink:01GJXW7GWRJD5T3ZN0B8JFEC2T","ns:uplink:01GJXW7GWRZV4K05AXJ7WSPR92","rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01GJXW7GWRE3RQ30T9875VRBY4","rpc:/ttn.lorawan.v3.NsAs/HandleUplink:01GJXW7H3NGVBN7C1PHFAMW4AG"],"received_at":"2022-11-28T01:04:40.053249840Z","uplink_message":{"session_key_id":"AYO8WVUO+SH3rOxBJneOtQ==","f_port":2,"f_cnt":3571,"frm_payload":"y+UGaAHHAQLCf/8=","decoded_payload":{"BatV":3.045,"Bat_status":3,"Ext_sensor":"Temperature Sensor","Hum_SHT":45.5,"TempC_DS":7.06,"TempC_SHT":16.4},"rx_metadata":[{"gateway_ids":{"gateway_id":"centrum-enschede","eui":"AC1F09FFFE057EE0"},"time":"2022-11-28T01:04:39.796787977Z","timestamp":780677337,"rssi":-114,"channel_rssi":-114,"snr":-1.5,"location":{"latitude":52.2212025684184,"longitude":6.88635438680649,"altitude":70,"source":"SOURCE_REGISTRY"},"uplink_token":"Ch4KHAoQY2VudHJ1bS1lbnNjaGVkZRIIrB8J//4FfuAQ2eGg9AIaDAinkpCcBhCTrdeMAyCon/uf3BY=","received_at":"2022-11-28T01:04:39.820317819Z"},{"gateway_ids":{"gateway_id":"packetbroker"},"packet_broker":{"message_id":"01GJXW7GWWVTJ8PBHVQ1MPT6VR","forwarder_net_id":"000013","forwarder_tenant_id":"ttnv2","forwarder_cluster_id":"ttn-v2-legacy-eu","forwarder_gateway_eui":"AA555A000806053F","forwarder_gateway_id":"eui-aa555a000806053f","home_network_net_id":"000013","home_network_tenant_id":"ttn","home_network_cluster_id":"eu1.cloud.thethings.network"},"time":"2022-11-28T01:04:39.816769Z","rssi":-103,"channel_rssi":-103,"snr":1.2,"location":{"latitude":52.22121,"longitude":6.8857374,"altitude":66},"uplink_token":"eyJnIjoiWlhsS2FHSkhZMmxQYVVwQ1RWUkpORkl3VGs1VE1XTnBURU5LYkdKdFRXbFBhVXBDVFZSSk5GSXdUazVKYVhkcFlWaFphVTlwU2tsUlZYaFRWbGR2TkZaVlVqUlNWMncxV201Vk5VbHBkMmxrUjBadVNXcHZhV0pHU214VGJHeDRaRzFhYkdKSGNGaE9WRlV5WTIxMGRXRnNXa05hZVVvNUxsZzNhVmhNTVMxelVsTjRaRXQwWlZObFQwdFJVSGN1VUUxaFVsWk9OWFpLUVU1NWFsVnRTeTV6U0U5bU9UVlRjRkl6WTJ4amRUWTNSbVZZV1hOMlFqTTRSSFkzYlZGTlEwSlpjM053U214aVltSkJNRmcxUWtOTmFrZDNUMDl3ZW1KMVoxOVNTMVJNVTFoMlFXVlJRbkU0TjNnelFsVjJVMTl5VUd0bWNGa3djVGt5WDJ0c1owMDBkMkZDVVZGYWVUUTJYM3BYTUUxcGFGaDBkM0pSTVhBelMwNUtkREUyYlRCWVdFdHZRa0pQWVVoek5YcEdjMlo1WTBkRWJtRlBaWFZuYkZnNVdYZFBRWEYyVDBsVlJVcDVkRkI1Y0RaUkxtNU1UM1pmVldGMlJHZGZRazVDZFVwdGFrRkpUM2M9IiwiYSI6eyJmbmlkIjoiMDAwMDEzIiwiZnRpZCI6InR0bnYyIiwiZmNpZCI6InR0bi12Mi1sZWdhY3ktZXUifX0=","received_at":"2022-11-28T01:04:39.833501226Z"}],"settings":{"data_rate":{"lora":{"bandwidth":125000,"spreading_factor":7,"coding_rate":"4/5"}},"frequency":"868500000","timestamp":780677337,"time":"2022-11-28T01:04:39.796787977Z"},"received_at":"2022-11-28T01:04:39.832517151Z","consumed_airtime":"0.061696s","version_ids":{"brand_id":"dragino","model_id":"lht65","hardware_version":"_unknown_hw_version_","firmware_version":"1.8","band_id":"EU_863_870"},"network_ids":{"net_id":"000013","tenant_id":"ttn","cluster_id":"eu1","cluster_address":"eu1.cloud.thethings.network"}}}'
PY_saxion = b'{"end_device_ids":{"device_id":"py-saxion","application_ids":{"application_id":"project-software-engineering"},"dev_eui":"70B3D5499ED96FBD","join_eui":"70B3D57ED00349D3","dev_addr":"260BF657"},"correlation_ids":["as:up:01GJZ2SVVC50N07G227X46C4JD","gs:conn:01GJYPYRQG88D315SEK80VWE5V","gs:up:host:01GJYPYRQMPHCSQJ25VQCWGHG6","gs:uplink:01GJZ2SVMYSNFGBBD27JVFM9RN","ns:uplink:01GJZ2SVMZPGJA1BWVHP596P73","rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01GJZ2SVMZAYZDGZBXJAQNKNDN","rpc:/ttn.lorawan.v3.NsAs/HandleUplink:01GJZ2SVVB54SRT0NRBB3DQW47"],"received_at":"2022-11-28T12:18:46.763444882Z","uplink_message":{"session_key_id":"AYS9g3uAoCsXwvK6i7uoUw==","f_port":2,"f_cnt":55,"frm_payload":"casqAQ==","decoded_payload":{"light":171,"pressure":1006.5,"temperature":22.1},"rx_metadata":[{"gateway_ids":{"gateway_id":"centrum-enschede","eui":"AC1F09FFFE057EE0"},"time":"2022-11-28T12:18:46.534919023Z","timestamp":3830303535,"rssi":-94,"channel_rssi":-94,"snr":12.5,"location":{"latitude":52.2212025684184,"longitude":6.88635438680649,"altitude":70,"source":"SOURCE_REGISTRY"},"uplink_token":"Ch4KHAoQY2VudHJ1bS1lbnNjaGVkZRIIrB8J//4FfuAQr5a3og4aDAimzpKcBhCr/LKKAiCY34b/vOkC","received_at":"2022-11-28T12:18:46.546850082Z"},{"gateway_ids":{"gateway_id":"packetbroker"},"packet_broker":{"message_id":"01GJZ2SVN0JN0795266VNCDHGA","forwarder_net_id":"000013","forwarder_tenant_id":"ttnv2","forwarder_cluster_id":"ttn-v2-legacy-eu","forwarder_gateway_eui":"AA555A000806053F","forwarder_gateway_id":"eui-aa555a000806053f","home_network_net_id":"000013","home_network_tenant_id":"ttn","home_network_cluster_id":"eu1.cloud.thethings.network"},"time":"2022-11-28T12:18:46.534247Z","rssi":-91,"channel_rssi":-91,"snr":9,"location":{"latitude":52.22121,"longitude":6.8857374,"altitude":66},"uplink_token":"eyJnIjoiWlhsS2FHSkhZMmxQYVVwQ1RWUkpORkl3VGs1VE1XTnBURU5LYkdKdFRXbFBhVXBDVFZSSk5GSXdUazVKYVhkcFlWaFphVTlwU2pGalJtdDRZbXBrYUZkVVZubFJWRnBNVDFkNGRVbHBkMmxrUjBadVNXcHZhVXhVWkVSVWJVcHRZVVZzYldOc1JURlNSV3hGWWpCME5tTkdhRk5SVTBvNUxsRXpXRVp0VEVsbllYRkNhRFpzV201Q2VuTnZTMEV1VHpsRVYwbFVVMUJqTUVwNVZ5MUhaeTVyZWxsYVFXVk1RWEZsTVVSek5rbG1Rak5xTnpGWE1uQkRaMVYzVjBvNU1HTjBjMjQ0WVd4WVRHSTVheTFWU0hCd1QzZGhVREpuVGtoZmJteE1URzU0WlhSU2RIUTVXVmh1UzJka2FIbHJSMnRGWjBsMWEydHlYell0Tm1weE1ESkVSelZSWmxwVWNFVlVVRkoxTTFCWGJpMXpReTFQZGtSRGRERk9TVTB3Vm1kNWFESTNTMkpIYld0U1dYWmhTMGxXTTBRNVl6azRVSFJtYkdKNlpHTkVOMFppV1c1dGMxSkpUR2c0T0VWdkxrcGpNRGczVjNweVZuVlZkRmRGUkdwSlNVZzJRMUU9IiwiYSI6eyJmbmlkIjoiMDAwMDEzIiwiZnRpZCI6InR0bnYyIiwiZmNpZCI6InR0bi12Mi1sZWdhY3ktZXUifX0=","received_at":"2022-11-28T12:18:46.557455435Z"}],"settings":{"data_rate":{"lora":{"bandwidth":125000,"spreading_factor":7,"coding_rate":"4/5"}},"frequency":"867700000","timestamp":3830303535,"time":"2022-11-28T12:18:46.534919023Z"},"received_at":"2022-11-28T12:18:46.559374248Z","consumed_airtime":"0.051456s","network_ids":{"net_id":"000013","tenant_id":"ttn","cluster_id":"eu1","cluster_address":"eu1.cloud.thethings.network"}}}'
LHT_gronau = b'{"end_device_ids":{"device_id":"lht-gronau","application_ids":{"application_id":"project-software-engineering"},"dev_eui":"A84041C1818350AD","join_eui":"A000000000000100","dev_addr":"260B6BA6"},"correlation_ids":["as:up:01GJZ2J8S23655VG75NG0ASMBH","gs:conn:01GJYR2GJX83GSCAAF4YN763WZ","gs:up:host:01GJYR2GK4GFP82MBYWY5YSF5Y","gs:uplink:01GJZ2J8JKM8280FDP02C18WY5","ns:uplink:01GJZ2J8JMDBX0B6M6C2W0GDGG","rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01GJZ2J8JMMWPKK8WBT5R7JETP","rpc:/ttn.lorawan.v3.NsAs/HandleUplink:01GJZ2J8S22EWVWF6KGN818N9K"],"received_at":"2022-11-28T12:14:37.858351913Z","uplink_message":{"session_key_id":"AXxKWF072JJcR3DkkkXENg==","f_port":2,"f_cnt":30253,"frm_payload":"y70DSgPPBQMpf/8=","decoded_payload":{"BatV":3.005,"Bat_status":3,"Hum_SHT":97.5,"ILL_lx":809,"TempC_SHT":8.42,"Work_mode":"Illumination Sensor"},"rx_metadata":[{"gateway_ids":{"gateway_id":"lora-gronau-centrum","eui":"58A0CBFFFE801F2C"},"time":"2022-11-28T12:14:37.586900949Z","timestamp":2410429643,"rssi":-101,"channel_rssi":-101,"snr":6.25,"location":{"latitude":52.21264520215403,"longitude":7.039657115346928,"source":"SOURCE_REGISTRY"},"uplink_token":"CiEKHwoTbG9yYS1ncm9uYXUtY2VudHJ1bRIIWKDL//6AHywQy/mw/QgaDAitzJKcBhDVn+O2AiD48bXGk8AC","received_at":"2022-11-28T12:14:37.605432008Z"}],"settings":{"data_rate":{"lora":{"bandwidth":125000,"spreading_factor":7,"coding_rate":"4/5"}},"frequency":"867300000","timestamp":2410429643,"time":"2022-11-28T12:14:37.586900949Z"},"received_at":"2022-11-28T12:14:37.652576755Z","consumed_airtime":"0.061696s","version_ids":{"brand_id":"dragino","model_id":"lht65","hardware_version":"_unknown_hw_version_","firmware_version":"1.8","band_id":"EU_863_870"},"network_ids":{"net_id":"000013","tenant_id":"ttn","cluster_id":"eu1","cluster_address":"eu1.cloud.thethings.network"}}}'
LHT_wierden = b'{"end_device_ids":{"device_id":"lht-wierden","application_ids":{"application_id":"project-software-engineering"},"dev_eui":"A840414E618350B1","join_eui":"A000000000000100","dev_addr":"260BCC18"},"correlation_ids":["as:up:01GJZ2ED8ZZSMS58W01ABM8V8T","gs:conn:01GJX73GBNKDH6NVRME3RBYA5F","gs:up:host:01GJX73GC1FFENW7KHN9FG5DYD","gs:uplink:01GJZ2ED2F6Z0620ZTPX2PZRFW","ns:uplink:01GJZ2ED2GMDR5NMJJN5GHEPZC","rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01GJZ2ED2GGYHSHPMT9CZWY112","rpc:/ttn.lorawan.v3.NsAs/HandleUplink:01GJZ2ED8YZBVQB6ANR6SCED9P"],"received_at":"2022-11-28T12:12:31.391042644Z","uplink_message":{"session_key_id":"AXxMYtR3CkBWclq0v9WHwQ==","f_port":2,"f_cnt":30224,"frm_payload":"y8sDPAPGBQK8f/8=","decoded_payload":{"BatV":3.019,"Bat_status":3,"Hum_SHT":96.6,"ILL_lx":700,"TempC_SHT":8.28,"Work_mode":"Illumination Sensor"},"rx_metadata":[{"gateway_ids":{"gateway_id":"slot-wierden","eui":"58A0CBFFFE8005DA"},"time":"2022-11-28T12:12:31.141145944Z","timestamp":2092131811,"rssi":-72,"channel_rssi":-72,"snr":9.25,"location":{"latitude":52.36891310514845,"longitude":6.602898538112641,"altitude":10,"source":"SOURCE_REGISTRY"},"uplink_token":"ChoKGAoMc2xvdC13aWVyZGVuEghYoMv//oAF2hDjy83lBxoLCK/LkpwGEJyL1VcguP2X5vGSDg==","received_at":"2022-11-28T12:12:31.165537373Z"}],"settings":{"data_rate":{"lora":{"bandwidth":125000,"spreading_factor":7,"coding_rate":"4/5"}},"frequency":"868300000","timestamp":2092131811,"time":"2022-11-28T12:12:31.141145944Z"},"received_at":"2022-11-28T12:12:31.184689095Z","consumed_airtime":"0.061696s","version_ids":{"brand_id":"dragino","model_id":"lht65","hardware_version":"_unknown_hw_version_","firmware_version":"1.8","band_id":"EU_863_870"},"network_ids":{"net_id":"000013","tenant_id":"ttn","cluster_id":"eu1","cluster_address":"eu1.cloud.thethings.network"}}}'
PY_wierden = b'{"end_device_ids":{"device_id":"py-wierden","application_ids":{"application_id":"project-software-engineering"},"dev_eui":"70B3D549963B71B0","join_eui":"70B3D57ED00349D3","dev_addr":"260B5D87"},"correlation_ids":["as:up:01GNDDRZGW8GRSAPVT5HZBGDPN","gs:conn:01GND1J75KXS00HWXZDE16GNDD","gs:up:host:01GND1J75W5DRHAG6KNYMX0RQZ","gs:uplink:01GNDDRZAAV85K8ZXE6W6PEV8S","ns:uplink:01GNDDRZABY8VNHYZ68S984VRE","rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01GNDDRZABA2P3N83HVRYDG74P","rpc:/ttn.lorawan.v3.NsAs/HandleUplink:01GNDDRZGVWTJ31V2HTEXW0ETR"],"received_at":"2022-12-28T22:31:17.788033693Z","uplink_message":{"session_key_id":"AYVERWjB/5r8d72HX4yzQQ==","f_port":2,"f_cnt":1845,"frm_payload":"agAqBA==","decoded_payload":{"light":0,"pressure":1003,"temperature":22.4},"rx_metadata":[{"gateway_ids":{"gateway_id":"slot-wierden","eui":"58A0CBFFFE8005DA"},"time":"2022-12-28T22:31:17.527929067Z","timestamp":4212899932,"rssi":-63,"channel_rssi":-63,"snr":7.5,"location":{"latitude":52.36891310514845,"longitude":6.602898538112641,"altitude":10,"source":"SOURCE_REGISTRY"},"uplink_token":"ChoKGAoMc2xvdC13aWVyZGVuEghYoMv//oAF2hDcgO/YDxoMCLWHs50GEPui25MCIODOnaPO9AI=","received_at":"2022-12-28T22:31:17.559923835Z"}],"settings":{"data_rate":{"lora":{"bandwidth":125000,"spreading_factor":7,"coding_rate":"4/5"}},"frequency":"867500000","timestamp":4212899932,"time":"2022-12-28T22:31:17.527929067Z"},"received_at":"2022-12-28T22:31:17.579328929Z","consumed_airtime":"0.051456s","network_ids":{"net_id":"000013","tenant_id":"ttn","cluster_id":"eu1","cluster_address":"eu1.cloud.thethings.network"}}}'

#               device_id           temperature         light           pressure        humidity

#  lht_wierden: lht-wierden            checked1             none            none            checked1

#  lht_saxion:  lht_saxion              checked1            none            none             checked1

#  py_saxion:  py_saxion              checked1             checked1        checked1         none

#  lht_gronau:  lht_gronau              checked1             none            none             checked1


LHT_saxion_to_string = json.loads(LHT_saxion)
LHT_saxion_device_id = LHT_saxion_to_string['end_device_ids']['device_id']
LHT_saxion_humidity = LHT_saxion_to_string['uplink_message']['decoded_payload']['Hum_SHT']
LHT_saxion_temperature = LHT_saxion_to_string['uplink_message']['decoded_payload']['TempC_DS']
LHT_saxion_timestamp = LHT_saxion_to_string['uplink_message']['rx_metadata'][0]['time']
LHT_saxion_battery_voltage = LHT_saxion_to_string['uplink_message']['decoded_payload']['BatV']
LHT_saxion_battery_status = LHT_saxion_to_string['uplink_message']['decoded_payload']['Bat_status']
LHT_saxion_latitude = LHT_saxion_to_string['uplink_message']['rx_metadata'][0]['location']['latitude']
LHT_saxion_longitude = LHT_saxion_to_string['uplink_message']['rx_metadata'][0]['location']['longitude']
# print(LHT_saxion_latitude)

PY_saxion_to_string = json.loads(PY_saxion)
PY_saxion_device_id = PY_saxion_to_string['end_device_ids']['device_id']
PY_saxion_temperature = PY_saxion_to_string['uplink_message']['decoded_payload']['temperature']
PY_saxion_light = PY_saxion_to_string['uplink_message']['decoded_payload']['light']
PY_saxion_pressure = PY_saxion_to_string['uplink_message']['decoded_payload']['pressure']
PY_saxion_timestamp = PY_saxion_to_string['uplink_message']['rx_metadata'][0]['time']
PY_saxion_battery_voltage = PY_saxion_to_string['uplink_message']['decoded_payload']
#['BatV']
PY_saxion_battery_status = PY_saxion_to_string['uplink_message']
#['Bat_status']
PY_saxion_latitude = PY_saxion_to_string['uplink_message']['rx_metadata'][0]['location']['latitude']
PY_saxion_longitude = PY_saxion_to_string['uplink_message']['rx_metadata'][0]['location']['longitude']

print(PY_saxion_battery_status)

LHT_gronau_to_string = json.loads(LHT_gronau)
LHT_gronau_device_id = LHT_gronau_to_string['end_device_ids']['device_id']
LHT_gronau_humidity = LHT_gronau_to_string['uplink_message']['decoded_payload']['Hum_SHT']
LHT_gronau_temperature = LHT_gronau_to_string['uplink_message']['decoded_payload']['TempC_SHT']
LHT_gronau_timestamp = LHT_gronau_to_string['uplink_message']['rx_metadata'][0]['time']
LHT_gronau_battery_voltage = LHT_gronau_to_string['uplink_message']['decoded_payload']['BatV']
LHT_gronau_battery_status = LHT_gronau_to_string['uplink_message']['decoded_payload']['Bat_status']
LHT_gronau_latitude = LHT_gronau_to_string['uplink_message']['rx_metadata'][0]['location']['latitude']
LHT_gronau_longitude = LHT_gronau_to_string['uplink_message']['rx_metadata'][0]['location']['longitude']

LHT_wierden_to_string = json.loads(LHT_wierden)
LHT_wierden_device_id = LHT_wierden_to_string['end_device_ids']['device_id']
LHT_wierden_humidity = LHT_wierden_to_string['uplink_message']['decoded_payload']['Hum_SHT']
LHT_wierden_temperature = LHT_wierden_to_string['uplink_message']['decoded_payload']['TempC_SHT']
LHT_wierden_timestamp = LHT_wierden_to_string['uplink_message']['rx_metadata'][0]['time']
LHT_wierden_battery_voltage = LHT_gronau_to_string['uplink_message']['decoded_payload']['BatV']
LHT_wierden_battery_status = LHT_gronau_to_string['uplink_message']['decoded_payload']['Bat_status']
LHT_wierden_latitude = LHT_gronau_to_string ['uplink_message']['rx_metadata'][0]['location']['latitude']
LHT_wierden_longitude = LHT_gronau_to_string ['uplink_message']['rx_metadata'][0]['location']['longitude']